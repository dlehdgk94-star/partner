<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Insta 파트너센터 - 예약 관리</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* 기본 스타일 초기화 */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #f5f7fa; color: #333; display: flex; min-height: 100vh; }

        /* --- 좌측 사이드바 --- */
        .sidebar { width: 240px; background-color: #ff6900; color: white; display: flex; flex-direction: column; flex-shrink: 0; }
        .sidebar-header { padding: 20px; font-size: 1.2rem; font-weight: bold; border-bottom: 1px solid rgba(255,255,255,0.1); display: flex; align-items: center; gap: 10px; }
        .menu-list { list-style: none; margin-top: 10px; }
        .menu-item { padding: 15px 20px; cursor: pointer; transition: background 0.2s; display: flex; align-items: center; gap: 10px; font-size: 0.95rem; }
        .menu-item:hover { background-color: #e65c00; }
        .menu-item.active { background-color: #cc5200; font-weight: bold; }

        /* --- 메인 콘텐츠 영역 --- */
        .main-content { flex-grow: 1; padding: 30px; overflow-y: auto; }
        .page-title { font-size: 1.5rem; font-weight: bold; margin-bottom: 10px; color: #333; }
        .page-desc { font-size: 0.9rem; color: #666; margin-bottom: 30px; }

        /* 섹션 공통 카드 스타일 */
        .card { background: white; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }

        /* 1. 주간 입실 현황 */
        .weekly-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .weekly-header h3 { font-size: 1rem; display: flex; align-items: center; gap: 8px; margin: 0; }
        
        /* 오늘 버튼 스타일 */
        .btn-today {
            font-size: 0.8rem;
            padding: 4px 10px;
            margin-left: 5px; 
            margin-right: 5px;
            border: 1px solid #ccc;
            background-color: white;
            border-radius: 4px;
            cursor: pointer;
            color: #333;
            transition: all 0.2s;
            font-family: 'Noto Sans KR', sans-serif;
        }
        .btn-today:hover {
            background-color: #f0f0f0;
            border-color: #999;
            color: #ff6900;
        }

        /* 날짜 이동 컨트롤러 */
        .date-slider-wrapper { display: flex; align-items: center; gap: 10px; }
        .nav-btn {
            background: white; border: 1px solid #ddd; border-radius: 50%; width: 32px; height: 32px;
            cursor: pointer; display: flex; align-items: center; justify-content: center; color: #555; transition: 0.2s;
        }
        .nav-btn:hover { background-color: #f0f0f0; color: #ff6900; border-color: #ff6900; }

        .date-container { display: flex; justify-content: space-between; gap: 10px; flex-grow: 1; }
        
        .date-box {
            border: 1px solid #ddd; border-radius: 4px; padding: 15px 0; flex: 1;
            text-align: center; cursor: pointer; position: relative; transition: all 0.2s;
        }
        .date-box:hover { border-color: #ffb080; }
        
        /* 활성화 상태 (주황색) */
        .date-box.active { border: 2px solid #ff6900; background-color: #fff0e6; }
        .date-box .date-text { font-size: 0.9rem; font-weight: bold; margin-bottom: 10px; color: #333; white-space: nowrap; }
        .date-box .count { font-size: 0.9rem; color: #ff6900; font-weight: bold; }
        
        /* 오늘 배지 */
        .today-badge {
            position: absolute; top: -10px; left: 50%; transform: translateX(-50%);
            background-color: #ff6900; color: white; font-size: 0.7rem; padding: 2px 6px; border-radius: 10px;
            display: none; 
        }
        .date-box.is-today .today-badge { display: block; }
        .date-box.is-today { border-color: #ff6900; } 

        /* [수정] 날짜 입력창 스타일 변경 (완전히 숨기지 않고 투명하게 처리하여 기능 보장) */
        #datePickerInput { 
            position: absolute; 
            opacity: 0; 
            z-index: -1; 
            width: 1px; 
            height: 1px; 
        }
        .calendar-trigger { cursor: pointer; color: #666; transition: 0.2s; margin-left: 5px; font-size: 1.1rem; }
        .calendar-trigger:hover { color: #ff6900; }

        /* 2. 검색 및 필터 */
        .search-filter { border: 1px solid #eee; }
        .filter-summary { margin-top: 20px; display: flex; justify-content: space-between; align-items: center; background-color: #f9f9f9; padding: 15px; border-radius: 4px; }
        .status-tabs button { padding: 8px 16px; border: 1px solid #ccc; background: white; cursor: pointer; font-size: 0.9rem; margin-right: -1px; }
        .status-tabs button.active { background-color: #ff6900; color: white; border-color: #ff6900; }
        .status-tabs button:first-child { border-radius: 4px 0 0 4px; }
        .status-tabs button:last-child { border-radius: 0 4px 4px 0; }

        /* 3. 데이터 테이블 */
        .table-controls { display: flex; justify-content: space-between; margin-bottom: 10px; align-items: center; }
        .summary-text { font-size: 0.9rem; font-weight: bold; }
        .data-table { width: 100%; border-collapse: collapse; font-size: 0.9rem; border-top: 2px solid #ddd; }
        .data-table th { background-color: #f5f5f5; padding: 12px; text-align: center; border-bottom: 1px solid #ddd; font-weight: bold; color: #555; }
        .data-table td { padding: 15px 12px; border-bottom: 1px solid #eee; vertical-align: middle; text-align: center; }
        
        .btn-detail { border: 1px solid #ccc; background: white; padding: 4px 8px; border-radius: 4px; cursor: pointer; font-size: 0.8rem; }
        .room-type { font-weight: bold; display: block; }
        .stay-info { font-size: 0.8rem; color: #ff6900; }
        .price-final { font-weight: bold; color: #333; }
        .btn-action { border: 1px solid #ccc; background: white; padding: 4px 8px; border-radius: 4px; cursor: pointer; margin-bottom: 4px; font-size: 0.8rem; width: 100%; }

    </style>
</head>
<body>

    <nav class="sidebar">
        <div class="sidebar-header">
            <i class="fa-solid fa-hotel"></i> insta 파트너센터
        </div>
        <ul class="menu-list">
            <li class="menu-item"><i class="fa-solid fa-house"></i> 홈</li>
            <li class="menu-item"><i class="fa-solid fa-calendar-check"></i> 판매 관리</li>
            <li class="menu-item active"><i class="fa-solid fa-list-check"></i> 예약</li>
            <li class="menu-item"><i class="fa-solid fa-calculator"></i> 정산</li>
        </ul>
    </nav>

    <main class="main-content">
        <h1 class="page-title">예약내역 통합검색</h1>
        <p class="page-desc">예약한 고객의 예약정보를 입실 일자별 & 상세 조건별로 조회할 수 있습니다.</p>

        <div class="card weekly-status">
            <div class="weekly-header">
                <h3>
                    <i class="fa-solid fa-bullhorn"></i> 1주일 간의 입실 현황
                    
                    <button id="todayBtn" class="btn-today">오늘</button>
                    
                    <span id="calendarIcon" class="calendar-trigger" title="달력 열기">
                        <i class="fa-regular fa-calendar-days"></i>
                    </span>
                    <input type="date" id="datePickerInput"> 
                </h3>
            </div>
            
            <p style="font-size: 0.85rem; color:#666; margin-bottom:15px;">
                화살표를 눌러 날짜를 이동하거나 <strong>달력 아이콘</strong>을 눌러 2026년, 2027년 등 먼 날짜를 조회하세요.<br>
            </p>
            
            <div class="date-slider-wrapper">
                <button class="nav-btn" id="prevDayBtn"><i class="fa-solid fa-chevron-left"></i></button>
                
                <div class="date-container" id="dynamicDateContainer">
                    </div>

                <button class="nav-btn" id="nextDayBtn"><i class="fa-solid fa-chevron-right"></i></button>
            </div>
        </div>

        <div class="card search-filter">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                <h4><i class="fa-solid fa-magnifying-glass"></i> 예약내역 상세 검색</h4>
                <button style="border:none; background:none; cursor:pointer;">펼치기 <i class="fa-solid fa-chevron-down"></i></button>
            </div>
            
            <div class="filter-box" style="border-top:1px solid #eee; padding-top:15px;">
                <p style="font-size:0.9rem; font-weight:bold; margin-bottom:5px;">선택된 조회 일자</p>
                <p style="font-size:0.9rem; color:#555;" id="selectedDateDisplay">날짜를 선택해주세요</p>
            </div>

            <div class="filter-summary">
                <div class="status-tabs">
                    <button class="active">입실 상태 전체</button>
                    <button>입실 전만 보기</button>
                    <button>입실 완료만 보기</button>
                </div>
            </div>

            <div style="margin-top:20px;">
                <div class="table-controls">
                    <span class="summary-text">총 2개 (완료 2 / 취소 0) | 매출액 85,000원</span>
                    <select style="padding:4px;">
                        <option>입실일 내림차순</option>
                    </select>
                </div>

                <table class="data-table">
                    <thead>
                        <tr>
                            <th>예약번호</th>
                            <th>예약자 정보</th>
                            <th>객실 타입</th>
                            <th>입실/퇴실일시</th>
                            <th>예약상태</th>
                            <th>금액</th>
                            <th>입실 상태</th>
                            <th>관리</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><button class="btn-detail">상세보기</button></td>
                            <td><strong>권품신</strong></td>
                            <td><span class="room-type">스탠다드</span><span class="stay-info">1박</span></td>
                            <td>2025.12.02(화) ~ 12.03</td>
                            <td>예약완료</td>
                            <td><span class="price-final">49,500원</span></td>
                            <td>입실완료</td>
                            <td><button class="btn-action">입실 호수 저장</button></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </main>

    <script>
        // --- 날짜 생성 로직 ---
        const dateContainer = document.getElementById('dynamicDateContainer');
        const prevBtn = document.getElementById('prevDayBtn');
        const nextBtn = document.getElementById('nextDayBtn');
        const datePicker = document.getElementById('datePickerInput');
        const calendarIcon = document.getElementById('calendarIcon'); // [추가] 아이콘 요소
        const selectedDateDisplay = document.getElementById('selectedDateDisplay');
        const todayBtn = document.getElementById('todayBtn'); 

        // 현재 기준 시작 날짜 (초기값: 오늘 기준 3일 전부터 시작)
        let currentStartDate = new Date();
        currentStartDate.setDate(currentStartDate.getDate() - 3);

        // 선택된 날짜 (초기값: 오늘)
        let selectedDate = new Date();

        // 날짜 포맷 함수
        function formatDate(date) {
            const days = ['일', '월', '화', '수', '목', '금', '토'];
            const yyyy = date.getFullYear();
            const mm = String(date.getMonth() + 1).padStart(2, '0');
            const dd = String(date.getDate()).padStart(2, '0');
            const dayName = days[date.getDay()];
            return `${yyyy}.${mm}.${dd} (${dayName})`;
        }

        // 같은 날짜인지 비교하는 헬퍼 함수
        function isSameDate(date1, date2) {
            return date1.getFullYear() === date2.getFullYear() &&
                   date1.getMonth() === date2.getMonth() &&
                   date1.getDate() === date2.getDate();
        }

        // 캘린더 렌더링 함수
        function renderCalendar() {
            dateContainer.innerHTML = ''; 
            const today = new Date();

            for (let i = 0; i < 7; i++) {
                // 보여줄 날짜 계산
                const renderDate = new Date(currentStartDate);
                renderDate.setDate(renderDate.getDate() + i);

                // 박스 요소 생성
                const box = document.createElement('div');
                box.className = 'date-box';
                
                // 오늘 날짜인지 확인
                if (isSameDate(renderDate, today)) {
                    box.classList.add('is-today');
                }

                // 현재 선택된 날짜인지 확인 (활성화 스타일)
                if (isSameDate(renderDate, selectedDate)) {
                    box.classList.add('active');
                    selectedDateDisplay.textContent = `선택된 입실일: ${formatDate(renderDate)}`;
                }

                // 오늘 배지
                const badge = isSameDate(renderDate, today) ? `<div class="today-badge">오늘</div>` : '';

                // 랜덤 예약 건수
                const randomCount = Math.floor(Math.random() * 15);

                box.innerHTML = `
                    ${badge}
                    <div class="date-text">${formatDate(renderDate)}</div>
                    <div class="count">숙박 ${randomCount}</div>
                `;

                // 클릭 이벤트
                box.addEventListener('click', () => {
                    selectedDate = new Date(renderDate);
                    renderCalendar(); 
                });

                dateContainer.appendChild(box);
            }
        }

        // 화살표 버튼 이벤트
        prevBtn.addEventListener('click', () => {
            currentStartDate.setDate(currentStartDate.getDate() - 1);
            renderCalendar();
        });

        nextBtn.addEventListener('click', () => {
            currentStartDate.setDate(currentStartDate.getDate() + 1);
            renderCalendar();
        });

        // 오늘 버튼 클릭 이벤트
        todayBtn.addEventListener('click', () => {
            const now = new Date();
            selectedDate = new Date(now); 
            
            // 오늘이 가운데 오도록 재설정
            currentStartDate = new Date(now);
            currentStartDate.setDate(currentStartDate.getDate() - 3);
            
            renderCalendar(); 
        });

        // [추가] 아이콘 클릭 시 달력(Date Picker) 강제 열기
        calendarIcon.addEventListener('click', () => {
            // 브라우저의 기본 Date Picker 열기 (최신 브라우저 지원 API)
            try {
                datePicker.showPicker();
            } catch (error) {
                // 구형 브라우저 등에서 showPicker 미지원 시 fallback
                // (일반적으로 label 연결로 작동하지만 명시적으로 focus)
                datePicker.focus();
                datePicker.click();
            }
        });

        // Date Picker 날짜 선택 완료(변경) 시 이벤트
        datePicker.addEventListener('change', (e) => {
            if(e.target.value) {
                const newDate = new Date(e.target.value);
                
                // 1. 선택된 날짜 업데이트
                selectedDate = new Date(newDate); 
                
                // 2. 슬라이더 위치 이동 (선택한 날짜가 가운데 오도록)
                currentStartDate = new Date(newDate);
                currentStartDate.setDate(currentStartDate.getDate() - 3);
                
                // 3. 화면 다시 그리기
                renderCalendar();
            }
        });

        // 초기 렌더링 실행
        renderCalendar();
    </script>
</body>
</html>
