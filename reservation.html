<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Insta 파트너센터 - 예약 관리</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* 기본 스타일 초기화 */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #f5f7fa; color: #333; display: flex; min-height: 100vh; }

        /* 사이드바 스타일 */
        .sidebar { width: 240px; background-color: #ff6900; color: white; display: flex; flex-direction: column; flex-shrink: 0; }
        .sidebar-header { padding: 20px; font-size: 1.2rem; font-weight: bold; border-bottom: 1px solid rgba(255,255,255,0.1); display: flex; align-items: center; gap: 10px; }
        .menu-list { list-style: none; margin-top: 10px; }
        .menu-item { padding: 15px 20px; cursor: pointer; transition: background 0.2s; display: flex; align-items: center; gap: 10px; font-size: 0.95rem; }
        .menu-item:hover { background-color: #e65c00; }
        .menu-item.active { background-color: #cc5200; font-weight: bold; }

        /* 메인 콘텐츠 영역 */
        .main-content { flex-grow: 1; padding: 30px; overflow-y: auto; }
        .page-title { font-size: 1.5rem; font-weight: bold; margin-bottom: 10px; color: #333; }
        .page-desc { font-size: 0.9rem; color: #666; margin-bottom: 30px; }

        /* 카드 공통 스타일 */
        .card { background: white; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }

        /* 주간 현황 헤더 컨트롤 스타일 */
        .weekly-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px; }
        .weekly-title { font-size: 1rem; font-weight: bold; display: flex; align-items: center; gap: 8px; }
        
        .date-controls { display: flex; align-items: center; gap: 10px; }
        .btn-today {
            background-color: #fff; border: 1px solid #ccc; padding: 5px 12px; border-radius: 4px; 
            font-size: 0.85rem; cursor: pointer; transition: 0.2s;
        }
        .btn-today:hover { background-color: #f0f0f0; border-color: #bbb; }
        
        .calendar-picker-wrapper { position: relative; display: flex; align-items: center; }
        .calendar-icon-btn {
            background: none; border: none; cursor: pointer; font-size: 1.2rem; color: #555;
            padding: 5px; transition: color 0.2s;
        }
        .calendar-icon-btn:hover { color: #ff6900; }
        #date-picker-input {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            opacity: 0; cursor: pointer;
        }

        /* 날짜 슬라이더 전체 영역 */
        .slider-wrapper {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 15px;
            background-color: #fff;
        }

        /* 좌우 화살표 버튼 */
        .nav-arrow {
            width: 40px; height: 80px; /* 버튼 크기 */
            border: 1px solid #eee; background-color: #fff;
            border-radius: 4px; cursor: pointer;
            color: #888; font-size: 1.2rem;
            display: flex; align-items: center; justify-content: center;
            transition: all 0.2s;
            margin-top: 10px; /* 박스 높이에 맞춰 중앙 정렬 보정 */
        }
        .nav-arrow:hover { background-color: #f9f9f9; color: #ff6900; border-color: #ff6900; }

        /* [수정] 날짜 박스 컨테이너 (7개 고정 노출) */
        .date-view-window {
            flex-grow: 1;
            overflow: hidden; /* 넘치는 것 숨김 */
            /* [중요] 뱃지가 위로 튀어나올 공간 확보 */
            padding-top: 25px; 
            padding-bottom: 5px;
        }
        .date-container { 
            display: flex; 
            gap: 10px; 
            width: 100%;
        }

        .date-box { 
            flex: 1; /* 부모 너비에 맞춰 7등분 */
            border: 1px solid #ddd; border-radius: 4px; padding: 15px 0; 
            text-align: center; cursor: pointer; position: relative; background: white;
            transition: border-color 0.2s, background-color 0.2s;
            min-width: 0; /* flex box 축소 방지 */
        }
        .date-box:hover { border-color: #ff6900; }
        .date-box.active { border: 2px solid #ff6900; background-color: #fff0e6; }
        
        .date-text { font-size: 0.9rem; font-weight: bold; margin-bottom: 10px; color: #333; white-space: nowrap; }
        .count { font-size: 0.9rem; color: #ff6900; font-weight: bold; white-space: nowrap; }
        
        /* [수정] 오늘 뱃지 스타일 */
        .today-badge { 
            position: absolute; 
            /* 테두리와 겹치지 않게 위로 이동 (-10px -> -24px) */
            top: -24px; 
            left: 50%; 
            transform: translateX(-50%); 
            background-color: #ff6900; 
            color: white; 
            font-size: 0.7rem; 
            padding: 3px 8px; 
            border-radius: 12px; 
            display: none; 
            white-space: nowrap;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1); /* 약간의 그림자 추가 */
            font-weight: bold;
        }
        .date-box.is-today .today-badge { display: block; }

        /* 검색 필터 스타일 */
        .search-filter { border: 1px solid #eee; }
        .filter-summary { margin-top: 20px; display: flex; justify-content: space-between; align-items: center; background-color: #f9f9f9; padding: 15px; border-radius: 4px; }
        .status-tabs button { padding: 8px 16px; border: 1px solid #ccc; background: white; cursor: pointer; font-size: 0.9rem; margin-right: -1px; }
        .status-tabs button.active { background-color: #ff6900; color: white; border-color: #ff6900; }
        .status-tabs button:first-child { border-radius: 4px 0 0 4px; }
        .status-tabs button:last-child { border-radius: 0 4px 4px 0; }

        /* 테이블 스타일 */
        .table-controls { display: flex; justify-content: space-between; margin-bottom: 10px; align-items: center; }
        .summary-text { font-size: 0.9rem; font-weight: bold; }
        .data-table { width: 100%; border-collapse: collapse; font-size: 0.9rem; border-top: 2px solid #ddd; }
        .data-table th { background-color: #f5f5f5; padding: 12px; text-align: center; border-bottom: 1px solid #ddd; font-weight: bold; color: #555; }
        .data-table td { padding: 15px 12px; border-bottom: 1px solid #eee; vertical-align: middle; text-align: center; }

        /* 테이블 내부 요소 */
        .room-type { font-weight: bold; display: block; }
        .stay-info { font-size: 0.8rem; color: #ff6900; }
        .price-original { text-decoration: line-through; color: #999; font-size: 0.8rem; display: block;}
        .price-final { font-weight: bold; color: #333; }
        
        .request-text { font-size: 0.85rem; color: #555; text-align: left; max-width: 150px; line-height: 1.4; }
        .sns-info { display: flex; flex-direction: column; gap: 4px; text-align: left; font-size: 0.8rem; color: #444; }
        .sns-item { display: flex; align-items: center; gap: 6px; }
        .sns-item i { width: 16px; text-align: center; color: #888; }
        .fa-instagram { color: #E1306C !important; }
        .fa-tiktok { color: #000000 !important; }
        .fa-envelope { color: #ff6900 !important; }

    </style>
</head>
<body>

    <nav class="sidebar">
        <div class="sidebar-header">
            <i class="fa-solid fa-hotel"></i> insta 파트너센터
        </div>
        <ul class="menu-list">
            <li class="menu-item"><i class="fa-solid fa-house"></i> 홈</li>
            <li class="menu-item"><i class="fa-solid fa-calendar-check"></i> 판매 관리</li>
            <li class="menu-item active"><i class="fa-solid fa-list-check"></i> 예약</li>
            <li class="menu-item"><i class="fa-solid fa-calculator"></i> 정산</li>
        </ul>
    </nav>

    <main class="main-content">
        <h1 class="page-title">예약내역 통합검색</h1>
        <p class="page-desc">예약한 고객의 예약정보를 입실 일자별 & 상세 조건별로 조회할 수 있습니다.</p>

        <div class="card weekly-status">
            <div class="weekly-header">
                <div class="weekly-title"><i class="fa-solid fa-bullhorn"></i> 입실 현황 캘린더</div>
                <div class="date-controls">
                    <button class="btn-today" id="btn-today">오늘</button>
                    <div class="calendar-picker-wrapper">
                        <button class="calendar-icon-btn"><i class="fa-regular fa-calendar-days"></i></button>
                        <input type="date" id="date-picker-input">
                    </div>
                </div>
            </div>

            <p style="font-size: 0.85rem; color:#666; margin-bottom:15px;">
                화살표를 눌러 이전/다음 날짜를 계속 확인할 수 있습니다.
            </p>
            
            <div class="slider-wrapper">
                <button class="nav-arrow" id="btn-prev"><i class="fa-solid fa-chevron-left"></i></button>
                
                <div class="date-view-window">
                    <div class="date-container" id="date-track">
                        </div>
                </div>

                <button class="nav-arrow" id="btn-next"><i class="fa-solid fa-chevron-right"></i></button>
            </div>
        </div>

        <div class="card search-filter">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                <h4><i class="fa-solid fa-magnifying-glass"></i> 예약내역 상세 검색</h4>
                <button style="border:none; background:none; cursor:pointer;">펼치기 <i class="fa-solid fa-chevron-down"></i></button>
            </div>
            
            <div class="filter-box" style="border-top:1px solid #eee; padding-top:15px;">
                <p style="font-size:0.9rem; font-weight:bold; margin-bottom:5px;">기간 설정 조건</p>
                <p style="font-size:0.9rem; color:#555;" id="selected-period-text">입실일 2025.12.02 (화) ~ 2025.12.02 (화)</p>
            </div>

            <div class="filter-summary">
                <div class="status-tabs">
                    <button class="active">입실 상태 전체</button>
                    <button>입실 전만 보기</button>
                    <button>입실 완료만 보기</button>
                </div>
            </div>

            <div style="margin-top:20px;">
                <div class="table-controls">
                    <span class="summary-text">총 2개 (완료 2 / 취소 0) | 매출액 85,000원 | 입금 예정가 76,500원</span>
                    <select style="padding:4px;">
                        <option>입실일 내림차순</option>
                    </select>
                </div>

                <table class="data-table">
                    <thead>
                        <tr>
                            <th>요청사항</th>
                            <th>예약자 정보</th>
                            <th>객실 타입</th>
                            <th>입실/퇴실일시</th>
                            <th>예약일시</th>
                            <th>예약상태</th>
                            <th>금액 및 할인정보</th>
                            <th>입실 상태</th>
                            <th>입실 정보 (연락처)</th>
                        </tr>
                    </thead>
                    <tbody id="reservation-list">
                        <tr>
                            <td><div class="request-text">조용한 방으로 부탁드립니다.</div></td>
                            <td><strong>권품신</strong></td>
                            <td>
                                <span class="room-type">스탠다드</span>
                                <span class="stay-info">숙박 / 1박</span>
                            </td>
                            <td>
                                2025.12.02(화) 17:00<br>
                                2025.12.03(수) 12:00
                            </td>
                            <td>
                                2025.11.27(목)<br>
                                <span style="font-size:0.8rem; color:#888;">미래예약</span>
                            </td>
                            <td>예약완료</td>
                            <td>
                                <span class="price-original">판매가 55,000원</span>
                                <span class="price-final">입금예정가 49,500원</span>
                            </td>
                            <td><input type="checkbox" checked> 입실완료</td>
                            <td>
                                <div class="sns-info">
                                    <div class="sns-item"><i class="fa-solid fa-envelope"></i> user1@naver.com</div>
                                    <div class="sns-item"><i class="fa-brands fa-instagram"></i> @kwon_insta</div>
                                    <div class="sns-item"><i class="fa-brands fa-tiktok"></i> @kwon_tik</div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td><div class="request-text">전망 좋은 방 주세요.</div></td>
                            <td><strong>유완규</strong></td>
                            <td>
                                <span class="room-type">럭셔리</span>
                                <span class="stay-info">숙박 / 1박</span>
                            </td>
                            <td>
                                2025.12.02(화) 10:30<br>
                                2025.12.02(화) 14:30
                            </td>
                            <td>
                                2025.12.02(화)<br>
                                <span style="font-size:0.8rem; color:#888;">당일건</span>
                            </td>
                            <td>예약완료</td>
                            <td>
                                <span class="price-original">판매가 30,000원</span>
                                <span class="price-final">입금예정가 27,000원</span>
                            </td>
                            <td><input type="checkbox"> 입실완료</td>
                            <td>
                                <div class="sns-info">
                                    <div class="sns-item"><i class="fa-solid fa-envelope"></i> user2@gmail.com</div>
                                    <div class="sns-item"><i class="fa-brands fa-instagram"></i> @yu_daily</div>
                                    <div class="sns-item"><i class="fa-brands fa-tiktok"></i> -</div>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div style="text-align:center; margin-top:20px;">
                <button style="border:1px solid #ddd; background:white; padding:5px 10px;">&lt;</button>
                <button style="border:1px solid #ff6900; background:white; color:#ff6900; font-weight:bold; padding:5px 10px;">1</button>
                <button style="border:1px solid #ddd; background:white; padding:5px 10px;">&gt;</button>
            </div>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const dateTrack = document.getElementById('date-track');
            const datePickerInput = document.getElementById('date-picker-input');
            const btnToday = document.getElementById('btn-today');
            const btnPrev = document.getElementById('btn-prev');
            const btnNext = document.getElementById('btn-next');
            const periodText = document.getElementById('selected-period-text');

            // 상태 변수
            let centerDate = new Date(); // 화면 중앙에 표시될 날짜
            let selectedDateStr = formatDate(centerDate); // 현재 선택(Active)된 날짜

            // 1. 초기 렌더링
            renderWeek(centerDate);

            // 2. 이벤트 리스너: 오늘 버튼
            btnToday.addEventListener('click', function() {
                const today = new Date();
                centerDate = new Date(today); // 중앙을 오늘로
                selectedDateStr = formatDate(today); // 선택도 오늘로
                renderWeek(centerDate);
            });

            // 3. 이벤트 리스너: 달력 선택
            datePickerInput.addEventListener('change', function(e) {
                if(e.target.value) {
                    const pickedDate = new Date(e.target.value);
                    centerDate = new Date(pickedDate); // 중앙을 선택일로
                    selectedDateStr = formatDate(pickedDate); // 선택도 선택일로
                    renderWeek(centerDate);
                }
            });

            // 4. 이벤트 리스너: 좌우 화살표 (하루씩 이동)
            btnPrev.addEventListener('click', function() {
                centerDate.setDate(centerDate.getDate() - 1);
                renderWeek(centerDate);
            });

            btnNext.addEventListener('click', function() {
                centerDate.setDate(centerDate.getDate() + 1);
                renderWeek(centerDate);
            });

            // 핵심 함수: centerDate를 기준으로 앞뒤 3일씩 총 7일을 렌더링
            function renderWeek(pivotDate) {
                dateTrack.innerHTML = ''; // 초기화

                const dayNames = ['일', '월', '화', '수', '목', '금', '토'];
                const todayStr = formatDate(new Date());

                // 기준일(중앙)로부터 -3일부터 +3일까지 루프 (총 7개)
                for (let i = -3; i <= 3; i++) {
                    const tempDate = new Date(pivotDate);
                    tempDate.setDate(tempDate.getDate() + i);

                    const yyyy = tempDate.getFullYear();
                    const mm = String(tempDate.getMonth() + 1).padStart(2, '0');
                    const dd = String(tempDate.getDate()).padStart(2, '0');
                    const dayName = dayNames[tempDate.getDay()];
                    
                    const dateString = `${yyyy}.${mm}.${dd}`; // 화면 표시용
                    const fullDateStr = `${yyyy}-${mm}-${dd}`; // 데이터 비교용 (formatDate함수 결과와 동일)

                    const box = document.createElement('div');
                    box.className = 'date-box';

                    // 오늘 뱃지
                    if (fullDateStr === todayStr) {
                        box.classList.add('is-today');
                    }

                    // 선택된 날짜 활성화 (배경색 변경)
                    if (fullDateStr === selectedDateStr) {
                        box.classList.add('active');
                        updatePeriodText(dateString, dayName);
                    }

                    // 박스 클릭 시 이벤트
                    box.addEventListener('click', function() {
                        // 선택 상태 변경
                        selectedDateStr = fullDateStr;
                        // 중앙 날짜는 변경하지 않고 선택 효과만 갱신 (원하면 중앙으로 오게 할 수도 있음)
                        renderWeek(centerDate); 
                    });

                    // 임시 데이터 (숙박 수)
                    let countNum = Math.floor(Math.random() * 5);
                    // 중앙 기준 너무 멀면 0으로 (데모용)
                    if (Math.abs(new Date() - tempDate) > 1000 * 60 * 60 * 24 * 30) countNum = 0; 

                    box.innerHTML = `
                        <div class="today-badge">오늘</div>
                        <div class="date-text">${dateString} (${dayName})</div>
                        <div class="count">숙박 ${countNum}</div>
                    `;
                    dateTrack.appendChild(box);
                }
            }

            // 날짜 포맷 (YYYY-MM-DD)
            function formatDate(date) {
                const yyyy = date.getFullYear();
                const mm = String(date.getMonth() + 1).padStart(2, '0');
                const dd = String(date.getDate()).padStart(2, '0');
                return `${yyyy}-${mm}-${dd}`;
            }

            // 하단 기간 텍스트 업데이트
            function updatePeriodText(dateStr, dayName) {
                periodText.innerText = `입실일 ${dateStr} (${dayName}) ~ ${dateStr} (${dayName})`;
            }
        });
    </script>
</body>
</html>
